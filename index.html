<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>A-Frame OBJ Model Viewer with Glow Effect</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/aframe/1.4.2/aframe.min.js"></script>
    <!-- Adding A-Frame postprocessing and effects for bloom -->
    <script src="https://unpkg.com/aframe-postprocessing-component/dist/aframe-postprocessing-component.min.js"></script>
    <style>
      body { margin: 0; overflow: hidden; }
      .ui-controls {
        position: absolute;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        background: rgba(0,0,0,0.5);
        color: white;
        padding: 10px;
        border-radius: 10px;
        text-align: center;
        z-index: 100;
      }
      .ui-controls button {
        margin: 0 5px;
        padding: 5px 10px;
        background: #333;
        color: white;
        border: 1px solid #555;
        border-radius: 5px;
        cursor: pointer;
      }
      .ui-controls button:hover {
        background: #444;
      }
      .glow-controls {
        position: absolute;
        top: 20px;
        right: 20px;
        background: rgba(0,0,0,0.5);
        color: white;
        padding: 10px;
        border-radius: 10px;
        text-align: center;
        z-index: 100;
      }
      .glow-controls label {
        display: block;
        margin: 5px 0;
      }
    </style>
  </head>
  <body>
    <a-scene background="color: #111122" postprocessing="enabled: true">
      <!-- Post-processing for bloom effect -->
      <a-entity
        bloom="radius: 0.66; strength: 1.5; threshold: 0.3"
        postprocessing="true">
      </a-entity>
      
      <!-- Asset Management System -->
      <a-assets>
        <a-asset-item id="model-obj" src="jupdroplight.obj"></a-asset-item>
        <a-asset-item id="model-mtl" src="jupdroplight.mtl"></a-asset-item>
      </a-assets>

      <!-- 3D Model with emissive material -->
      <a-entity id="model" 
                obj-model="obj: #model-obj; mtl: #model-mtl" 
                position="0 0 -5" 
                rotation="0 0 0" 
                scale="1 1 1"
                material="emissive: #66ccff; emissiveIntensity: 0.9">
      </a-entity>

      <!-- Camera -->
      <a-entity id="camera" camera position="0 1.6 0" look-controls wasd-controls>
        <a-entity cursor="fuse: false"
                  position="0 0 -1"
                  geometry="primitive: ring; radiusInner: 0.02; radiusOuter: 0.03"
                  material="color: white; shader: flat">
        </a-entity>
      </a-entity>

      <!-- Lighting -->
      <a-entity light="type: ambient; color: #444; intensity: 0.5"></a-entity>
      <a-entity light="type: directional; color: #FFF; intensity: 0.6" position="-0.5 1 1"></a-entity>
      <a-entity light="type: directional; color: #FFF; intensity: 0.6" position="0.5 1 -1"></a-entity>
    </a-scene>

    <!-- UI Controls -->
    <div class="ui-controls">
      <button onclick="rotateModel('left')">Rotate Left</button>
      <button onclick="zoomModel('in')">Zoom In</button>
      <button onclick="zoomModel('out')">Zoom Out</button>
      <button onclick="rotateModel('right')">Rotate Right</button>
    </div>

    <!-- Glow Controls -->
    <div class="glow-controls">
      <label>Glow Color:
        <select id="glowColor" onchange="updateGlowColor()">
          <option value="#66ccff">Blue</option>
          <option value="#ff9900">Orange</option>
          <option value="#ff3366">Red</option>
          <option value="#33ff99">Green</option>
          <option value="#ffffff">White</option>
        </select>
      </label>
      <label>Glow Intensity:
        <input type="range" id="glowIntensity" min="0" max="2" step="0.1" value="0.9" onchange="updateGlowIntensity()">
      </label>
      <label>Bloom Strength:
        <input type="range" id="bloomStrength" min="0" max="3" step="0.1" value="1.5" onchange="updateBloomStrength()">
      </label>
    </div>

    <script>
      // Wait for the model to load
      document.addEventListener('DOMContentLoaded', function() {
        const model = document.getElementById('model');
        
        // Center the model (assuming the model is loaded)
        setTimeout(() => {
          // Set position to be visible in front of camera
          model.setAttribute('position', '0 0 -5');
        }, 1000);
      });

      // Rotate the model
      function rotateModel(direction) {
        const model = document.getElementById('model');
        const currentRotation = model.getAttribute('rotation');
        const rotationAmount = direction === 'left' ? 15 : -15;
        
        model.setAttribute('rotation', {
          x: currentRotation.x,
          y: currentRotation.y + rotationAmount,
          z: currentRotation.z
        });
      }

      // Zoom in/out of the model
      function zoomModel(direction) {
        const model = document.getElementById('model');
        const currentPosition = model.getAttribute('position');
        const zoomAmount = direction === 'in' ? -0.5 : 0.5;
        
        // Don't let the model get too close to the camera
        if (currentPosition.z + zoomAmount > -1 && direction === 'in') {
          return;
        }
        
        model.setAttribute('position', {
          x: currentPosition.x,
          y: currentPosition.y,
          z: currentPosition.z + zoomAmount
        });
      }

      // Update glow color
      function updateGlowColor() {
        const model = document.getElementById('model');
        const color = document.getElementById('glowColor').value;
        const material = model.getAttribute('material') || {};
        material.emissive = color;
        model.setAttribute('material', material);
      }

      // Update glow intensity
      function updateGlowIntensity() {
        const model = document.getElementById('model');
        const intensity = document.getElementById('glowIntensity').value;
        const material = model.getAttribute('material') || {};
        material.emissiveIntensity = intensity;
        model.setAttribute('material', material);
      }

      // Update bloom strength
      function updateBloomStrength() {
        const bloomEntity = document.querySelector('[bloom]');
        const strength = document.getElementById('bloomStrength').value;
        const bloom = bloomEntity.getAttribute('bloom') || {};
        bloom.strength = strength;
        bloomEntity.setAttribute('bloom', bloom);
      }
    </script>
  </body>
</html>
